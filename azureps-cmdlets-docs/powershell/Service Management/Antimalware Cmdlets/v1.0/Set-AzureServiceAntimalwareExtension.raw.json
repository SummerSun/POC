{"_lang":"csharp","_tocPath":"toc.yml","_navPath":"toc.yml","_rel":"../../../","_path":"Service Management/Antimalware Cmdlets/v1.0/Set-AzureServiceAntimalwareExtension","_navRel":"../../../toc.yml","_tocRel":"../../../toc.yml","_navKey":"~/toc.yml","_tocKey":"~/toc.yml","synopsis":"Configures the Microsoft Antimalware extension for cloud services.","isWorkflow":false,"extent":{"line":{"start":0,"end":1},"column":{"start":0,"end":0},"offset":{"start":0,"end":0},"originalText":"# Set-AzureServiceAntimalwareExtension\r\n"},"isSupportCommonParameters":false,"notes":"","inputs":[],"outputs":[],"links":[{"isSimplifiedTextLink":false,"linkName":"Get-AzureServiceAntimalwareConfig","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Get-AzureServiceAntimalwareConfig"},{"isSimplifiedTextLink":false,"linkName":"Remove-AzureServiceAntimalwareExtension","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Remove-AzureServiceAntimalwareExtension"}],"syntax":[{"isDefault":false,"code":"Set-AzureServiceAntimalwareExtension [-ServiceName] <String> [-Slot] [[-Role] <String[]>]\r\n [[-AntimalwareConfiguration] <XmlDocument>] [-Monitoring] [[-StorageContext] <AzureStorageContext>]"}],"examples":[{"title":"Example 1: Enable the extension","code":"PS C:\\>[System.Xml.XmlDocument] $XmlConfig = New-Object System.Xml.XmlDocument <br />PS C:\\> $XmlConfig.load('C:\\configuration\\contosoVM.xml')<br />PS C:\\> Set-AzureServiceAntimalwareExtension -ServiceName \"ContosoService03\" -AntimalwareConfiguration $XmlConfig<br />Operation succeeded","remarks":"The first two commands create an XmlDocument object that contains a configuration for the Microsoft Antimalware extension, and then stores it in the $XmlConfig variable.<br />The third command enables the Microsoft Antimalware extension for the service named ContosoService03, by using the configuration stored in $XmlConfig. Because the command does not specify the Slot parameter, the cmdlet uses the default value, Production.","introduction":""},{"title":"Example 2: Enable the extension for the Staging slot","code":"PS C:\\>[System.Xml.XmlDocument] $XmlConfig = New-Object System.Xml.XmlDocument <br />PS C:\\> $XmlConfig.load('C:\\configuration\\contosoVM.xml')<br />PS C:\\> Set-AzureServiceAntimalwareExtension -ServiceName \"ContosoService03\" -Slot \"Staging\" -AntimalwareConfiguration $XmlConfig <br />Operation succeeded","remarks":"The first two commands create an XmlDocument object that contains a configuration for the Microsoft Antimalware extension, and then stores it in the $XmlConfig variable.<br />The third command enables the Microsoft Antimalware extension for the service named ContosoService03, by using the configuration stored in $XmlConfig. This command specifies a value of Staging for the Slot parameter.","introduction":""},{"title":"Example 3: Enable the extension with monitoring","code":"PS C:\\>[System.Xml.XmlDocument] $XmlConfig = New-Object System.Xml.XmlDocument <br />PS C:\\> $XmlConfig.load('C:\\configuration\\contosoVM.xml')<br />PS C:\\> $StorageContext = New-AzureStorageContext -StorageAccountName \"contosostoragemain\" -StorageAccountKey (Get-AzureStorageKey -StorageAccountName \"Contosostoragemain\").Primary<br />PS C:\\> Set-AzureServiceAntimalwareExtension -ServiceName \"ContosoService03\" -AntimalwareConfiguration $XmlConfig -Monitoring ON -StorageContext $StorageContext","remarks":"The first two commands create an XmlDocument object that contains a configuration for the Microsoft Antimalware extension, and then stores it in the $XmlConfig variable.<br />The third command creates an AzureStorageContext object by using the New-AzureStorageContext cmdlet, and then stores it in the $StorageContext variable.<br />The final command enables the Microsoft Antimalware extension for the service named ContosoService03, by using the configuration stored in $XmlConfig. This command also specifies a value of ON for the Monitoring parameter and specifies the Azure storage context stored in $StorageContext. The values specified by these parameters override any corresponding values for these parameters that were specified within the XML configuration.","introduction":""}],"parameters":[{"extent":{"line":{"start":68,"end":69},"column":{"start":496,"end":496},"offset":{"start":496,"end":496},"originalText":"### -AntimalwareConfiguration\r\n"},"type":"XmlDocument","name":"AntimalwareConfiguration","isRequired":false,"description":"Specifies an XmlDocument object that contains the Microsoft Antimalware configuration. This object must not be $Null or empty. The configuration object must include, at a minimum, the following content to enable the Microsoft Antimalware extension: <br /><AntimalwareConfig><AntimalwareEnabled>true</AntimalwareEnabled></AntimalwareConfig><br />You can configure the following settings in this configuration file: <br />Setting: <AntimalwareEnabled> Values: true (case sensitive)  A value of true enables the Microsoft Antimalware extension. The value false is not supported. This setting is required.  Default: None<br />Setting: <RealtimeProtectionEnabled> Values: true or false (case sensitive)  A value of true enables Real-time protection. A value of false disables Real-time protection.  Default: true when <AntimalwareEnabled> has a value of true. <br />Setting: <ScheduledScanSettings> isEnabled attribute Values: true or false (case sensitive)  Enables or disables a periodic scan for active malware.  Default: false<br />Setting: <ScheduledScanSettings> day attribute Values: 0 through 8<br /> -- 0: Scan daily -- 1: Scan Sunday<br />-- 2: Scan Monday<br />-- 3: Scan Tuesday<br />-- 4: Scan Wednesday<br />-- 5: Scan Thursday<br />-- 6: Scan Friday<br />-- 7: Scan Saturday<br />-- 8: Disabled<br /><br />Default: 7 if you specify a value of true for the isEnabled attribute of <ScheduledScanSettings><br />Setting: <ScheduledScanSettings> time attribute  Values: 0 through 1440 Specify the hour at which to begin the scan in increments of 60 minutes after midnight. Specify a value of 60 for 1:00 A.M.  Default: 120 if you specify a value of true for the isEnabled attribute of <ScheduledScanSettings> <br />Setting: <ScheduledScanSettings> scanType attribute Values: Quick or Full Default: Quick if you specify a value of true for the isEnabled attribute of <ScheduledScanSettings> <br />Setting: Exclusions for file name extensions Values: File name extensions List the file name extensions to exclude from scanning. To exclude files that have the file name extensions .gif, .log, or .txt, specify the following text: <br />gif, log, txt<br />For cloud service XML configuration, add each file name extension as a separate row element value in your configuration XML. In JavaScript Object Notation (JSON) configuration, add all file name extensions as a semicolon separated list.  Default: None<br />Setting: Exclusions for paths Values: File and folder paths Description: List the paths of files or folders to exclude from scanning. To exclude the file worker.dll in the e:\\approot folder and anything under the folder e:\\approot\\temp, specify the following paths: <br />e:\\approot\\worker.dll, e:\\approot\\temp<br />For JSON configuration for virtual machines, use a second slash as an escape character for the slash, as in e:\\\\approot\\\\worker.dll.  Add each excluded path as a separate row element value in your configuration XML. In JSON configuration, add all excluded paths as a semicolon separated list.  Default: None<br />Setting: Exclusions for processes Values: Process names List the process exclusions. The Microsoft Antimalware extension does not scan any file that an excluded process opens. The Microsoft Antimalware extension scans the process itself. To exclude the process itself, use the <Paths> element. The Microsoft Antimalware extension excludes from scanning any file opened by the MyApp.exe based on this example: <br />C:\\Program Files\\MyApp.exe<br />Add each excluded process as a separate row element value in your configuration XML.  Default: None<br />Setting: <Monitoring> Values: ON or OFF A value of ON enables antimalware monitoring using the Azure diagnostics extension. A value of OFF disables antimalware monitoring by removing antimalware monitoring configuration if it was previously ON.  Default: OFF<br />Setting: <StorageAccountName> Values: Storage account name Specifies the name of the storage account for your Azure store table to collect antimalware events in storage. If you specified a value of ON for <Monitoring>, you must specify a storage account name.  Default: None<br />The following is an example of a configuration file that contains additional settings: <br /><AntimalwareConfig>     <AntimalwareEnabled>true</AntimalwareEnabled>      <RealtimeProtectionEnabled>true</RealtimeProtectionEnabled><br /><ScheduledScanSettings isEnabled=\"true\" day=\"7\" time=\"120\" scanType=\"Quick\" />      <Exclusions>          <Extensions> <Extension>.ext1</Extension> <Extension>.ext2</Extension>         </Extensions>         <Paths> <Path>c:\\excluded-path-1</Path> <Path>c:\\excluded-path-2</Path>         </Paths>         <Processes> <Process>excludedproc1.exe</Process> <Process>excludedproc2.exe</Process>         </Processes>     </Exclusions>     <Monitoring>ON</Monitoring>     <StorageAccountName>contosostorage</StorageAccountName> </AntimalwareConfig><br />We do not recommend the use of wildcard characters in the exclusion settings.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"4","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":206,"end":207},"column":{"start":588,"end":588},"offset":{"start":588,"end":588},"originalText":"### -Monitoring\r\n"},"type":"SwitchParameter","name":"Monitoring","isRequired":false,"description":"Specifies whether to collect Microsoft Antimalware events. Valid values are: <br />-- ON. Collect Microsoft Antimalware events to storage context. -- OFF. Do not collect Microsoft Antimalware events.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"5","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":["ON","OFF"]},{"extent":{"line":{"start":228,"end":229},"column":{"start":588,"end":588},"offset":{"start":588,"end":588},"originalText":"### -Role\r\n"},"type":"String[]","name":"Role","isRequired":false,"description":"Specifies an array of roles. The default value is all roles.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"3","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":244,"end":245},"column":{"start":588,"end":588},"offset":{"start":588,"end":588},"originalText":"### -ServiceName\r\n"},"type":"String","name":"ServiceName","isRequired":true,"description":"Specifies the name of the cloud service.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"1","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":259,"end":260},"column":{"start":588,"end":588},"offset":{"start":588,"end":588},"originalText":"### -Slot\r\n"},"type":"SwitchParameter","name":"Slot","isRequired":false,"description":"Specifies a deployment slot. Valid values are: <br />-- Production<br />-- Staging<br /><br />The default value is Production.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"2","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":["Production","Staging"]},{"extent":{"line":{"start":281,"end":282},"column":{"start":588,"end":588},"offset":{"start":588,"end":588},"originalText":"### -StorageContext\r\n"},"type":"AzureStorageContext","name":"StorageContext","isRequired":false,"description":"Specifies an Azure storage context for Microsoft Antimalware monitoring. You must specify a valid storage context when monitoring is set to ON.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"6","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]}],"children":[],"uid":"Service Management/Antimalware Cmdlets/v1.0/Set-AzureServiceAntimalwareExtension","name":"Set-AzureServiceAntimalwareExtension","description":"The Set-AzureServiceAntimalwareExtension cmdlet configures the Microsoft Antimalware extension for a cloud service. You can specify values that override and supplement values in the XML configuration, such as storage account context.","overwrite_metadata":{"external_help_file":"Azure_antimalware.xml","online_version":"http://go.microsoft.com/fwlink/?LinkID=402843","schema":"2.0.0","ms.topic":"reference","ms.date":"9/1/2016","source_repo":"https://github.com/azure/azure-docs-powershell","source_branch":"master","source":{"remote":{"path":"azureps-cmdlets-docs/Service Management/Antimalware Cmdlets/v1.0/Set-AzureServiceAntimalwareExtension.md","branch":"master","repo":"https://github.com/Visual-Studio-China/azure-powershell-docs-int.git"},"startLine":0,"endLine":0,"isExternal":false},"breadcrumb_path":"/powershell/breadcrumb.json","_docfxVersion":"2.5.0.0","_gitContribute":{"path":"azureps-cmdlets-docs\\apispec","branch":"master","repo":"https://github.com/Visual-Studio-China/azure-powershell-docs-int.git"},"ms.service":"Azure PowerShell","ms.technology":"Azure PowerShell","ms.prod":"powershell"},"_op_gitCommitHistory":[{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"27b880b052924864433e026d3893452e774177b3","commit_date":"2016-09-01 16:35:23 +0000"},{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"2b7e89f09c2585152b2cfdbf66d3e9b1e99f6b6e","commit_date":"2016-08-31 02:31:15 +0000"},{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"e2c65d16552e19a8effd32a0ec6fe73c6bfafdd5","commit_date":"2016-08-29 09:50:22 +0000"}],"ref_skeleton_gitcommit":"https://github.com/Visual-Studio-China/azure-powershell-docs-int/blob/27b880b052924864433e026d3893452e774177b3/azureps-cmdlets-docs/Service%20Management/Antimalware%20Cmdlets/v1.0/Set-AzureServiceAntimalwareExtension.md","original_ref_skeleton_git_url":"https://github.com/Visual-Studio-China/azure-powershell-docs-int/blob/master/azureps-cmdlets-docs/Service%20Management/Antimalware%20Cmdlets/v1.0/Set-AzureServiceAntimalwareExtension.md","open_to_public_contributors":false,"updated_at":"2016-09-02 12:35 AM","__global":{"_shared":{}}}