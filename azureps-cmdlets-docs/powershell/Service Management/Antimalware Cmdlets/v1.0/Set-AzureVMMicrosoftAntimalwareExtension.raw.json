{"_lang":"csharp","_tocPath":"toc.yml","_navPath":"toc.yml","_rel":"../../../","_path":"Service Management/Antimalware Cmdlets/v1.0/Set-AzureVMMicrosoftAntimalwareExtension","_navRel":"../../../toc.yml","_tocRel":"../../../toc.yml","_navKey":"~/toc.yml","_tocKey":"~/toc.yml","synopsis":"Configures the Microsoft Antimalware extension for a virtual machine.","isWorkflow":false,"extent":{"line":{"start":0,"end":1},"column":{"start":0,"end":0},"offset":{"start":0,"end":0},"originalText":"# Set-AzureVMMicrosoftAntimalwareExtension\r\n"},"isSupportCommonParameters":false,"notes":"","inputs":[],"outputs":[],"links":[{"isSimplifiedTextLink":false,"linkName":"Get-AzureVM","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Get-AzureVM"},{"isSimplifiedTextLink":false,"linkName":"Update-AzureVM","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Update-AzureVM"},{"isSimplifiedTextLink":false,"linkName":"Get-AzureVMMicrosoftAntimalwareExtension","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Get-AzureVMMicrosoftAntimalwareExtension"},{"isSimplifiedTextLink":false,"linkName":"Remove-AzureVMMicrosoftAntimalwareExtension","linkUri":"xref:Service Management\\Antimalware Cmdlets\\v1.0\\Remove-AzureVMMicrosoftAntimalwareExtension"}],"syntax":[{"parameterSetName":"UNNAMED_PARAMETER_SET_1","isDefault":false,"code":"Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>] [-Monitoring]\r\n [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>"},{"parameterSetName":"UNNAMED_PARAMETER_SET_2","isDefault":false,"code":"Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>] [-Monitoring]\r\n [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>"},{"parameterSetName":"UNNAMED_PARAMETER_SET_3","isDefault":false,"code":"Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>] [-Monitoring]\r\n [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>"},{"parameterSetName":"UNNAMED_PARAMETER_SET_4","isDefault":false,"code":"Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>] [-Monitoring]\r\n [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>"},{"parameterSetName":"UNNAMED_PARAMETER_SET_5","isDefault":false,"code":"Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>] [-Monitoring]\r\n [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>"}],"examples":[{"title":"Example 1: Enable the extension by using a configuration file","code":"PS C:\\>Get-AzureVM -ServiceName \"ContosoService03\" -Name \"ContosoVM22\" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfigFile 'C:\\configuration\\contosoVM.json' | Update-AzureVM","remarks":"This command enables the Microsoft Antimalware extension by using a configuration file. The command uses the Get-AzureVM cmdlet to get the specified virtual machine object, and then passes the object to the current cmdlet by using the pipeline operator.<br />The AntimalwareConfigFile parameter specifies a configuration file for the Microsoft Antimalware extension. Set-AzureVMMicrosoftAntimalwareExtension applies the configuration that the file specifies to the virtual machine, and then passes the result to the Update-AzureVM cmdlet to update the virtual machine.","introduction":""},{"title":"Example 2: Enable the extension and enable monitoring","code":"PS C:\\>$StorageContext = New-AzureStorageContext -StorageAccountName \"contosostoragemain\" -StorageAccountKey (Get-AzureStorageKey -StorageAccountName \"Contosostoragemain\").Primary<br />PS C:\\> Get-AzureVM -ServiceName \"ContosoService03\" -Name\"ContosoVM22\" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfigFile 'C:\\configuration\\contosoVM.xml\" -Monitoring ON -StorageContext $StorageContext | Update-AzureVM","remarks":"The first command creates an AzureStorageContext object by using the New-AzureStorageContext cmdlet, and then stores it in the $StorageContext variable.<br />The second command enables the Microsoft Antimalware extension, and enables monitoring. The command uses Get-AzureVM to get the specified virtual machine object, and then passes the object to the current cmdlet.<br />The command specifies a value of ON for the Monitoring parameter and specifies the Azure storage context stored in $StorageContext, and then passes the result to the Update-AzureVM cmdlet.","introduction":""},{"title":"Example 3: Enable the extension by specifying a configuration object","code":"PS C:\\>$config_string = '{\"AntimalwareEnabled\" : true}'<br />PS C:\\> Get-AzureVM -ServiceName \"ContosoService03\" -Name \"ContosoVM22\" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfiguration $config_string | Update-AzureVM","remarks":"The first command creates a string object by reading a JSON configuration for the Microsoft Antimalware extension, and then storing it in the $config_string variable.<br />The second command uses Get-AzureVM to get the specified virtual machine object, and then passes the object to Set-AzureVMMicrosoftAntimalwareExtension to apply that configuration to the virtual machine. The AntimalwareConfiguration parameter specifies the configuration information stored in $config_string. The result is passed to the Update-AzureVM cmdlet.","introduction":""},{"title":"Example 4: Disable the extension","code":"PS C:\\>Get-AzureVM -ServiceName \"ContosoService03\" -Name \"ContosoVM22\" | Set-AzureVMMicrosoftAntimalwareExtension -Disable | Update-AzureVM","remarks":"This command disables the extension without removing it. The command uses Get-AzureVM to get the specified virtual machine object, and then passes the object to the current cmdlet.<br />Set-AzureVMMicrosoftAntimalwareExtension disables the Microsoft Antimalware extension for the virtual machine, and then passes the result to Update-AzureVM.<br />To enable the extension on the same virtual machine again, run Set-AzureVMMicrosoftAntimalwareExtension cmdlet without specifying the Disable parameter.","introduction":""},{"title":"Example 5: Remove the extension","code":"PS C:\\>Get-AzureVM -ServiceName \"ContosoService03\" -Name\"ContosoVM22\" | Set-AzureVMMicrosoftAntimalwareExtension -Uninstall | Update-AzureVM","remarks":"This command removes the Microsoft Antimalware extension from the virtual machine. The command uses Get-AzureVM to get the specified virtual machine object, and then passes the object to the current cmdlet.<br />Set-AzureVMMicrosoftAntimalwareExtension removes the extension. If monitoring was turned on, the cmdlet also removes the collection of Microsoft Antimalware events. The command passes the result to Update-AzureVM.","introduction":""}],"parameters":[{"extent":{"line":{"start":101,"end":102},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -AntimalwareConfigFile\r\n"},"type":"String","name":"AntimalwareConfigFile","isRequired":true,"description":"Specifies the absolute path to the Microsoft Antimalware configuration file. Donâ€™t specify this parameter if you specify the AntimalwareConfiguration parameter. The configuration file must include, at a minimum, the following content to enable the Microsoft Antimalware extension: <br />{ \"AntimalwareEnabled\": true }<br />You can configure the following settings in this configuration file: <br />Setting: AntimalwareEnabled Values: true (case sensitive)  A value of true enables the Microsoft Antimalware extension. The value false is not supported. This setting is required.  Default: None<br />Setting: RealtimeProtectionEnabled Values: true or false (case sensitive)  A value of true enables Real-time protection. A value of false disables Real-time protection.  Default: true when AntimalwareEnabled has a value of true. <br />Setting: ScheduledScanSettings isEnabled property Values: true or false (case sensitive)  Enables or disables a periodic scan for active malware.  Default: false<br />Setting: ScheduledScanSettings day property Values: 0 through 8<br /> -- 0: Scan daily -- 1: Scan Sunday<br />-- 2: Scan Monday<br />-- 3: Scan Tuesday<br />-- 4: Scan Wednesday<br />-- 5: Scan Thursday<br />-- 6: Scan Friday<br />-- 7: Scan Saturday<br />-- 8: Disabled<br /><br />Default: 7 if you specify a value of true for the isEnabled property of ScheduledScanSettings<br />Setting: ScheduledScanSettings time property  Values: 0 through 1440 Specify the hour at which to begin the scan in increments of 60 minutes after midnight. Specify a value of 60 for 1:00 A.M.  Default: 120 if you specify a value of true for the isEnabled property of ScheduledScanSettings <br />Setting: ScheduledScanSettings scanType property Values: Quick or Full Default: Quick if you specify a value of true for the isEnabled property of ScheduledScanSettings <br />Setting: Exclusions for file name extensions Values: File name extensions List the file name extensions to exclude from scanning. To specify multiple file types to exclude, separate each entry with a semicolon. To exclude files that have the file name extensions .gif, .log, or .txt, specify the following text: <br />gif; log; txt<br />For JavaScript Object Notation (JSON) configuration, separate multiple file name extensions by using the semicolon. We do not recommend that you use wildcard characters.  Default: None<br />Setting: Exclusions for paths Values: File and folder paths List the paths of files or folders to exclude from scanning. To specify multiple paths to exclude, separate each entry with a semicolon. To exclude the file worker.dll in the e:\\approot folder and anything under the folder e:\\approot\\temp, specify the following paths: <br />e:\\\\approot\\\\worker.dll; e:\\\\approot\\\\temp<br />For JSON configuration for virtual machines, use a second slash as an escape character for the slash, as in e:\\\\approot\\\\worker.dll.  Add all excluded paths as a semicolon separated list in JSON configuration. We do not recommend that you use wildcard characters.  Default: None<br />Setting: Exclusions for processes Values: Process names List the process exclusions. The Microsoft Antimalware extension does not scan any file that an excluded process opens. The Microsoft Antimalware extension scans the process itself. To exclude the process itself, use the Paths property. To specify multiple processes to exclude, separate each entry with a semicolon. The Microsoft Antimalware extension excludes from scanning any file opened by the MyApp.exe based on this example: <br />C:\\\\Program Files\\\\MyApp.exe<br />This example uses a second slash as an escape character. Add all excluded processes as a semicolon separated list in JSON configuration.  Default: None<br />The following is an example of a configuration file containing additional settings. Note that slash characters in exclusion paths must be properly escaped, by specifying two slashes. Using wildcard characters in the exclusion set is not recommended.<br />{   \"AntimalwareEnabled\": true,      \"RealtimeProtectionEnabled\": true,         \"ScheduledScanSettings\": {         \"isEnabled\": true,          \"day\": 1,          \"time\": 120,          \"scanType\": \"Full\"   },   \"Exclusions\": {     \"Extensions\": \".ext1;.ext2\",     \"Paths\": \"c:\\\\excluded-path-1;c:\\\\excluded-path-2\",     \"Processes\": \"excludedproc1.exe;excludedproc2.exe\"   } }","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True (ByPropertyName)","position":"2","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":225,"end":226},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -AntimalwareConfiguration\r\n"},"type":"String","name":"AntimalwareConfiguration","isRequired":true,"description":"Specifies a string object that contains the Microsoft Antimalware configuration. This object must not be $Null or empty. Donâ€™t specify this parameter if you specify the AntimalwareConfigFile parameter. The configuration object must include, at a minimum, the following content to enable the Microsoft Antimalware extension: <br />{ \"AntimalwareEnabled\": true }","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"2","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":245,"end":246},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -Disable\r\n"},"type":"SwitchParameter","name":"Disable","isRequired":false,"description":"Indicates that the cmdlet disables the Microsoft Antimalware extension. To re-enable the extension on the same virtual machine, run Set-AzureVMMicrosoftAntimalwareExtension without the Disable parameter.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True (ByPropertyName)","position":"3","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":261,"end":262},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -Monitoring\r\n"},"type":"SwitchParameter","name":"Monitoring","isRequired":false,"description":"Specifies whether to collect Microsoft Antimalware events. Valid values are: <br />-- ON. Collect Microsoft Antimalware events to the specified storage context. -- OFF. Do not collect Microsoft Antimalware events.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"4","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":["ON","OFF"]},{"extent":{"line":{"start":283,"end":284},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -NoConfig\r\n"},"type":"SwitchParameter","name":"NoConfig","isRequired":true,"description":"You can configure the following settings in this configuration file: <br />Setting: AntimalwareEnabled Values: true (case sensitive)  A value of true enables the Microsoft Antimalware extension. The value false is not supported. This setting is required.  Default: None<br />Setting: RealtimeProtectionEnabled Values: true or false (case sensitive)  A value of true enables Real-time protection. A value of false disables Real-time protection.  Default: true when AntimalwareEnabled has a value of true. <br />Setting: ScheduledScanSettings isEnabled property Values: true or false (case sensitive)  Enables or disables a periodic scan for active malware.  Default: false<br />Setting: ScheduledScanSettings day property Values: 0 through 8<br /> -- 0: Scan daily -- 1: Scan Sunday<br />-- 2: Scan Monday<br />-- 3: Scan Tuesday<br />-- 4: Scan Wednesday<br />-- 5: Scan Thursday<br />-- 6: Scan Friday<br />-- 7: Scan Saturday<br />-- 8: Disabled<br /><br />Default: 7 if you specify a value of true for the isEnabled property of ScheduledScanSettings<br />Setting: ScheduledScanSettings time property  Values: 0 through 1440 Specify the hour at which to begin the scan in increments of 60 minutes after midnight. Specify a value of 60 for 1:00 A.M.  Default: 120 if you specify a value of true for the isEnabled property of ScheduledScanSettings <br />Setting: ScheduledScanSettings scanType property Values: Quick or Full Default: Quick if you specify a value of true for the isEnabled property of ScheduledScanSettings <br />Setting: Exclusions for file name extensions Values: File name extensions List the file name extensions to exclude from scanning. To specify multiple file types to exclude, separate each entry with a semicolon. To exclude files that have the file name extensions .gif, .log, or .txt, specify the following text: <br />gif; log; txt<br />For JavaScript Object Notation (JSON) configuration, separate multiple file name extensions by using the semicolon. We do not recommend that you use wildcard characters.  Default: None<br />Setting: Exclusions for paths Values: File and folder paths List the paths of files or folders to exclude from scanning. To specify multiple paths to exclude, separate each entry with a semicolon. To exclude the file worker.dll in the e:\\approot folder and anything under the folder e:\\approot\\temp, specify the following paths: <br />e:\\\\approot\\\\worker.dll; e:\\\\approot\\\\temp<br />For JSON configuration for virtual machines, use a second slash as an escape character for the slash, as in e:\\\\approot\\\\worker.dll.  Add all excluded paths as a semicolon separated list in JSON configuration. We do not recommend that you use wildcard characters.  Default: None<br />Setting: Exclusions for processes Values: Process names List the process exclusions. The Microsoft Antimalware extension does not scan any file that an excluded process opens. The Microsoft Antimalware extension scans the process itself. To exclude the process itself, use the Paths property. To specify multiple processes to exclude, separate each entry with a semicolon. The Microsoft Antimalware extension excludes from scanning any file opened by the MyApp.exe based on this example: <br />C:\\\\Program Files\\\\MyApp.exe<br />This example uses a second slash as an escape character. Add all excluded processes as a semicolon separated list in JSON configuration.  Default: None<br />The following is an example of a configuration file containing additional settings. Note that slash characters in exclusion paths must be properly escaped, by specifying two slashes. Using wildcard characters in the exclusion set is not recommended.<br />{   \"AntimalwareEnabled\": true,      \"RealtimeProtectionEnabled\": true,         \"ScheduledScanSettings\": {         \"isEnabled\": true,          \"day\": 1,          \"time\": 120,          \"scanType\": \"Full\"   },   \"Exclusions\": {     \"Extensions\": \".ext1;.ext2\",     \"Paths\": \"c:\\\\excluded-path-1;c:\\\\excluded-path-2\",     \"Processes\": \"excludedproc1.exe;excludedproc2.exe\"   } }","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"4","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":401,"end":402},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -StorageContext\r\n"},"type":"AzureStorageContext","name":"StorageContext","isRequired":false,"description":"Specifies an Azure storage context for Microsoft Antimalware monitoring. You must specify a valid storage context when monitoring is set to ON.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"5","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":417,"end":418},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -Uninstall\r\n"},"type":"SwitchParameter","name":"Uninstall","isRequired":true,"description":"Indicates that this cmdlet uninstalls the Microsoft Antimalware extension from the virtual machine. If monitoring was turned on, the cmdlet also removes the collection of Microsoft Antimalware events.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True (ByPropertyName)","position":"2","aliases":[],"isValueRequired":false,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":433,"end":434},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -Version\r\n"},"type":"String","name":"Version","isRequired":false,"description":"Specifies the extension version as a string.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True(ByPropertyName)","position":"3","aliases":[],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]},{"extent":{"line":{"start":460,"end":461},"column":{"start":760,"end":760},"offset":{"start":760,"end":760},"originalText":"### -VM\r\n"},"type":"IPersistentVM","name":"VM","isRequired":true,"description":"Specifies the virtual machine as an IPersistentVM object.","defaultValue":"None","variableLength":true,"acceptWildcardCharacters":false,"pipelineInput":"True (ByValue, ByPropertyName)","position":"Named","aliases":["InputObject"],"isValueRequired":true,"valueVariableLength":false,"parameterValueGroup":[]}],"children":[],"uid":"Service Management/Antimalware Cmdlets/v1.0/Set-AzureVMMicrosoftAntimalwareExtension","name":"Set-AzureVMMicrosoftAntimalwareExtension","description":"The Set-AzureVMMicrosoftAntimalwareExtension cmdlet configures the Microsoft Antimalware extension for a virtual machine. You can enable, disable, or uninstall the extension.","overwrite_metadata":{"external_help_file":"Azure_antimalware.xml","online_version":"http://go.microsoft.com/fwlink/?LinkID=402844","schema":"2.0.0","ms.topic":"reference","ms.date":"9/1/2016","source_repo":"https://github.com/azure/azure-docs-powershell","source_branch":"master","source":{"remote":{"path":"azureps-cmdlets-docs/Service Management/Antimalware Cmdlets/v1.0/Set-AzureVMMicrosoftAntimalwareExtension.md","branch":"master","repo":"https://github.com/Visual-Studio-China/azure-powershell-docs-int.git"},"startLine":0,"endLine":0,"isExternal":false},"breadcrumb_path":"/powershell/breadcrumb.json","_docfxVersion":"2.5.0.0","_gitContribute":{"path":"azureps-cmdlets-docs\\apispec","branch":"master","repo":"https://github.com/Visual-Studio-China/azure-powershell-docs-int.git"},"ms.service":"Azure PowerShell","ms.technology":"Azure PowerShell","ms.prod":"powershell"},"_op_gitCommitHistory":[{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"27b880b052924864433e026d3893452e774177b3","commit_date":"2016-09-01 16:35:23 +0000"},{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"2b7e89f09c2585152b2cfdbf66d3e9b1e99f6b6e","commit_date":"2016-08-31 02:31:15 +0000"},{"author_name":"Summer","author_email":"victoriasqq@gmail.com","committer_name":"Summer","comitter_email":"victoriasqq@gmail.com","message":"commit from appveyor","commit_sha":"e2c65d16552e19a8effd32a0ec6fe73c6bfafdd5","commit_date":"2016-08-29 09:50:22 +0000"}],"ref_skeleton_gitcommit":"https://github.com/Visual-Studio-China/azure-powershell-docs-int/blob/27b880b052924864433e026d3893452e774177b3/azureps-cmdlets-docs/Service%20Management/Antimalware%20Cmdlets/v1.0/Set-AzureVMMicrosoftAntimalwareExtension.md","original_ref_skeleton_git_url":"https://github.com/Visual-Studio-China/azure-powershell-docs-int/blob/master/azureps-cmdlets-docs/Service%20Management/Antimalware%20Cmdlets/v1.0/Set-AzureVMMicrosoftAntimalwareExtension.md","open_to_public_contributors":false,"updated_at":"2016-09-02 12:35 AM","__global":{"_shared":{}}}